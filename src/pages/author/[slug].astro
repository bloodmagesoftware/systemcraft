---
import { type CollectionEntry, getCollection } from "astro:content";
import Layout from "../../layouts/App.astro";
import Footer from "../../components/Footer.astro";

export async function getStaticPaths() {
	const courses = await getCollection("courses");
	const authors = await getCollection("authors");

	return authors.map((author) => ({
		params: { slug: author.id },
		props: {
			author: author,
			courses: courses.filter((c) =>
				c.data.authors.find((a) => a.id === author.id),
			),
		},
	}));
}

type Props = {
	author: CollectionEntry<"authors">;
	courses: CollectionEntry<"courses">[];
};

const { courses, author } = Astro.props;
---

<Layout>
	<div
		class="mx-auto w-full max-w-7xl"
		style={{ minHeight: "calc(100lvh - 24rem)" }}
	>
		<h1 class="mb-8 font-serif text-2xl font-bold">{author.data.name}</h1>
		<div
			class="grid grid-cols-1 gap-4 px-2 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"
		>
			{
				courses.map((course) => (
					<a
						class="rounded border border-solid border-gray-700 px-4 py-2"
						href={`/courses/${course.slug}`}
					>
						<h3 class="font-serif font-bold">{course.data.title}</h3>
						<p class="text-balance text-gray-400">{course.data.description}</p>
					</a>
				))
			}
		</div>
	</div>
	<Footer />
</Layout>
